# Maintainer: Aditya Shakya <adi1090x@gmail.com>
# Developer : Amir Salihefendic <@amix3k>

pkgname=archcraft-vim
pkgver=1.0
pkgrel=3
pkgdesc="The ultimate Vim configuration (vimrc) "
arch=('any')
url='https://github.com/amix/vimrc'
license=('GPL')
depends=('vim')
makedepends=('git')
optdepends=()

source=("git+https://github.com/amix/vimrc.git")

sha256sums=('SKIP')

prepare() {
  	cd ${srcdir}/vimrc

	# Show line numbers
	sed -i -e 's/set foldcolumn=.*/set foldcolumn=0/g' ${srcdir}/vimrc/vimrcs/basic.vim
	sed -i -e '/set foldcolumn=0/a set number' ${srcdir}/vimrc/vimrcs/basic.vim
	
	# Change color scheme
	sed -i -e 's/colorscheme .*/colorscheme ir_black/g' ${srcdir}/vimrc/vimrcs/extended.vim

	# Create .vimrc file
	touch .vimrc
	cat >> ".vimrc" <<- _EOF_
		" DO NOT EDIT THIS FILE
		" Add your own customizations in ~/.vim_runtime/my_configs.vim

		set runtimepath+=~/.vim_runtime

		source ~/.vim_runtime/vimrcs/basic.vim
		source ~/.vim_runtime/vimrcs/filetypes.vim
		source ~/.vim_runtime/vimrcs/plugins_config.vim
		source ~/.vim_runtime/vimrcs/extended.vim
		try
		  source ~/.vim_runtime/my_configs.vim
		catch
		endtry
	_EOF_
}

package() {
  	cd ${srcdir}/vimrc
	mkdir -p ${pkgdir}/etc/skel/.vim_runtime
	cp -r . ${pkgdir}/etc/skel/.vim_runtime
	install -Dm 644 ".vimrc" ${pkgdir}/etc/skel
	rm ${pkgdir}/etc/skel/.vim_runtime/.vimrc
}
